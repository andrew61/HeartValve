@model HeartValve.Models.MeasurementsViewModel


@if (!Request.UserAgent.ToLower().Contains("ipad"))
{
    <div class="box">
        <div class="box-col">
            <button id="ExportOxygenSaturation" class='k-button k-primary'>Save Graph as PDF</button>
        </div>
    </div>
}

@(Html.Kendo().Chart()
    .Name("OxygenSaturationChart")
    .Title("Oxygen Saturation Measurements")
    .Legend(legend => legend
        .Visible(true)
        .Position(ChartLegendPosition.Bottom)
    )
    .Tooltip(tooltip => tooltip
        .Visible(true).Shared(true)
    )
    .Series(series =>
    {
        series.Line(Model.Spo2Series).Name("Spo2").Color("Black");
        series.Line(Model.HeartRateSeries).Name("HeartRate").Color("Red");
    })
    .CategoryAxis(axis => axis
    .Categories(Model.ReadingDate)
    .MajorGridLines(lines => lines.Visible(false))
    )
    .ValueAxis(axis => axis.Numeric()
    .Labels(labels => labels.Format("{0:N0}"))
    //.PlotBands(bands =>
    //{
    //   bands.Add().From(Model.Thresholds.Sp02Min).To(Model.Thresholds.Sp02Max).Color("green").Opacity(0.5);
    //   bands.Add().From(Model.Thresholds.HeartRateMin).To(Model.Thresholds.HeartRateMax).Color("green").Opacity(0.5);
    //})
    )
    .ChartArea(x => x.Height(350))
    .Pdf(pdf => pdf
        .FileName("Oxygen Saturation Readings.pdf")
    )
)

<script type="text/javascript">
    $("#ExportOxygenSaturation").click(function () {
        $("#OxygenSaturationChart").getKendoChart().saveAsPDF();
    });
</script>